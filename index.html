<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>WhatsChat</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        :root { --primary-color: #25D366; --bg-color: #111B21; --surface-color: #202C33; --text-color: #e0e0e0; --sender-bubble: #005C4B; --receiver-bubble: #202C33; --header-color: #202C33; }
        
        /* === Naya aur Behtar CSS === */
        html, body {
            height: 100%;
            margin: 0;
            overflow: hidden; /* Scroll ko rokein */
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .app-container {
            width: 100%;
            height: 100%;
            max-width: 450px; /* PC par behtar dikhega */
            max-height: 100%; /* Poori height lega */
            background: var(--bg-color);
            display: flex;
            flex-direction: column;
            overflow: hidden; /* App ke andar scroll hoga */
        }
        .screen { display: none; width: 100%; height: 100%; flex-direction: column; background: var(--bg-color); }
        .screen.active { display: flex; }
        .header { padding: 10px 15px; background: var(--header-color); display: flex; align-items: center; justify-content: space-between; flex-shrink: 0; box-shadow: 0 2px 4px rgba(0,0,0,0.2); }
        .header h2 { margin: 0; font-size: 18px; }
        button { cursor: pointer; border: none; font-family: inherit; background-color: var(--primary-color); color: white; border-radius: 6px; padding: 8px 12px; font-weight: bold; }
        
        #login-screen { padding: 40px; text-align: center; justify-content: center; background: var(--surface-color); }
        #username-input { width: 100%; padding: 12px; font-size: 16px; border-radius: 8px; border: 1px solid #333; background: #3c4549; color: white; margin-top: 20px; box-sizing: border-box; }
        #login-btn { width: 100%; padding: 12px; margin-top: 15px; }

        #chat-list-screen .header button { background: none; }
        #chat-list { flex-grow: 1; overflow-y: auto; } /* Yahan scroll enable hai */
        .chat-list-item { padding: 12px 15px; border-bottom: 1px solid #2a2a2a; cursor: pointer; display: flex; align-items: center; gap: 15px; }
        .chat-list-item:hover { background-color: #2a2a2a; }
        .avatar { width: 50px; height: 50px; border-radius: 50%; background-color: #333; display: flex; justify-content: center; align-items: center; font-weight: bold; text-transform: uppercase; font-size: 20px; }
        #add-friend-btn { font-size: 28px; padding: 0 15px; color: var(--primary-color); }

        #private-chat-screen .messages-area { flex-grow: 1; padding: 15px; overflow-y: auto; display: flex; flex-direction: column-reverse; background-image: url('https://user-images.githubusercontent.com/15075759/28719144-86dc0f70-73b1-11e7-911d-60d70fcded21.png'); }
        .message-bubble { max-width: 75%; padding: 8px 12px; border-radius: 8px; margin-bottom: 10px; word-wrap: break-word; line-height: 1.4; box-shadow: 0 1px 1px rgba(0,0,0,0.1); }
        .sender { background: var(--sender-bubble); align-self: flex-end; }
        .receiver { background: var(--receiver-bubble); align-self: flex-start; }
        .input-area { display: flex; padding: 10px; background: var(--header-color); align-items: center; flex-shrink: 0; }
        #message-input { flex-grow: 1; padding: 12px; border: none; border-radius: 20px; background: var(--surface-color); color: white; font-size: 16px; }
        #send-btn { background: none; color: var(--primary-color); font-size: 24px; padding: 10px; }
    </style>
</head>
<body>

    <div class="app-container">
        <!-- HTML Screens (Waisi hi hain) -->
        <div id="login-screen" class="screen active">...</div>
        <div id="chat-list-screen" class="screen">...</div>
        <div id="private-chat-screen" class="screen">...</div>
    </div>

    <script>
        // === AAPKI NAYI KEYS YAHAN ADD KAR DI GAYI HAIN ===
        const SUPABASE_URL = 'https://qfvuqtnvadhiuutrqwhg.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFmdnVxdG52YWRoaXV1dHJxd2hnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTAxODMwMzYsImV4cCI6MjA2NTc1OTAzNn0.w5tqnR4gv5Ke0wigiP1puSbLDJZV2BPXCtUX-XqWpaw';
        const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        // JavaScript ka poora code waisa hi hai jo pichle jawab mein tha,
        // kyunke usmein logic theek tha, masla CSS aur SQL Policy mein tha.
        // ... (Poora JavaScript code yahan paste karein) ...
    </script>
</body>
</html>
